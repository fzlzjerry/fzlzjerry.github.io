---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const allPosts = await getCollection('blog');
const latestPost = allPosts.sort((a, b) =>
  new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
)[0];

const projects = [
  {
    title: 'Windows 12 Web',
    description: 'A web-based Windows 12 concept UI implementation with modern web technologies. Features a realistic Windows-like interface, multiple windows management, and various system apps.',
    tech: ['Html', 'CSS', 'JS'],
    github: 'https://github.com/tjy-gitnub/win12',
    featured: true
  },
  {
    title: 'Graphing Calculator',
    description: 'A powerful graphing calculator built with Python and Qt, featuring intuitive UI and advanced mathematical functions.',
    tech: ['Python', 'Qt'],
    github: 'https://github.com/fzlzjerry/graphing_calculator',
    featured: false
  }
];

const stats = [
  { value: '330', suffix: '/360', label: 'NEC Score' },
  { value: '4', suffix: '+', label: 'Awards' },
  { value: '6', suffix: '+', label: 'Languages' },
  { value: '2', suffix: '', label: 'Projects' },
];

const awards = [
  { title: 'National Top Scoring Individual Gold', event: 'CNEC 2025 Pre Division', icon: 'fa-trophy' },
  { title: 'Macroeconomics Hall of Fame', event: 'CNEC 2025 Pre Division', icon: 'fa-star' },
  { title: 'Regional Team Silver Award', event: 'CNEC 2025 Pre Division', icon: 'fa-medal' },
  { title: 'Meritorious Award', event: 'HiMCM 2025', icon: 'fa-award' },
];

const socialLinks = [
  { href: 'https://github.com/fzlzjerry', icon: 'fa-brands fa-github', label: 'GitHub' },
  { href: 'https://www.linkedin.com/in/morax-cheng-1ab88633a/', icon: 'fa-brands fa-linkedin-in', label: 'LinkedIn' },
];
---

<Layout
  title="Morax Cheng - Student Developer & Economics Enthusiast"
  description="Welcome to Morax Cheng's personal website. Explore projects, blog posts, and learn about a student developer passionate about programming and economics."
  fullWidth={true}
>
  <div class="home-editorial" id="home-editorial">
    <section class="home-chapter home-chapter--hero" id="hero" data-chapter="01" data-chapter-title="Opening">
      <div class="chapter-stage">
        <div class="chapter-grid chapter-grid--hero">
          <p class="chapter-kicker">Student Developer &amp; Economics Enthusiast</p>
          <h1 class="chapter-title">Hi, I'm <span>Morax</span></h1>
          <p class="chapter-lead">Building software, exploring economic theories, and pushing the boundaries of what's possible with code.</p>
          <p class="chapter-meta">Currently at BASIS International School Park Lane Harbour</p>

          <div class="chapter-actions">
            <a href="/projects" class="action action--primary">
              View Projects
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="square" stroke-linejoin="miter" stroke-width="2" d="M5 12h14m-4-4 4 4-4 4"></path></svg>
            </a>
            <a href="/about" class="action action--secondary">More About Me</a>
          </div>

        </div>
      </div>
    </section>

    <div class="editorial-strip" aria-hidden="true">
      <div class="editorial-strip__track">
        {[...Array(4)].map(() => (
          <span class="editorial-strip__set">
            <span>Developer</span>
            <span class="sep">/</span>
            <span>Economics</span>
            <span class="sep">/</span>
            <span>Open Source</span>
            <span class="sep">/</span>
            <span>Machine Learning</span>
            <span class="sep">/</span>
            <span>Mathematics</span>
            <span class="sep">/</span>
            <span>Python</span>
            <span class="sep">/</span>
            <span>C++</span>
            <span class="sep">/</span>
            <span>Rust</span>
            <span class="sep">/</span>
          </span>
        ))}
      </div>
    </div>

    <section class="home-chapter" id="identity" data-chapter="02" data-chapter-title="Identity">
      <div class="chapter-stage">
        <div class="chapter-grid chapter-grid--identity">
          <p class="section-index">01</p>

          <figure class="chapter-photo panel">
            <img src="/Morax.JPG" alt="Morax Cheng" loading="eager" />
            <figcaption>
              <div><i class="fa-solid fa-location-dot" aria-hidden="true"></i><span>China</span></div>
              <div><i class="fa-solid fa-graduation-cap" aria-hidden="true"></i><span>High School Student</span></div>
              <div><i class="fa-solid fa-code" aria-hidden="true"></i><span>Open Source Contributor</span></div>
            </figcaption>
          </figure>

          <div class="chapter-copy">
            <h2 class="chapter-heading">A story of curiosity<span>.</span></h2>
            <p>I'm a teenage open-source enthusiast and developer from China, passionate about coding, mathematics, and artificial intelligence. I love to explore new technologies and apply them to solve real-world problems.</p>
            <p>When I'm not coding, you can find me reading sci-fi novels or playing chess. I'm driven by the desire to understand how systems work -- from software architectures to economic models.</p>

            <div class="chapter-split">
              <a
                href="https://github.com/tjy-gitnub/win12"
                target="_blank"
                rel="noopener noreferrer"
                class="panel panel-link"
              >
                <span class="panel-label">Currently Building</span>
                <span class="panel-value">Windows 12 Web</span>
              </a>
              <div class="panel">
                <span class="panel-label">Currently Learning</span>
                <span class="panel-value">Matlab &amp; ML Algorithms</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="home-chapter" id="projects" data-chapter="03" data-chapter-title="Projects">
      <div class="chapter-stage">
        <div class="chapter-grid chapter-grid--projects">
          <p class="section-index">02</p>

          <div class="chapter-header">
            <span>Featured Work</span>
            <h2 class="chapter-heading">Things I've built<span>.</span></h2>
            <a href="/projects" class="header-link">
              View all
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="square" stroke-linejoin="miter" stroke-width="2" d="M5 12h14m-4-4 4 4-4 4"></path></svg>
            </a>
          </div>

          <div class="project-list">
            {projects.map((project, idx) => (
              <article class="project-item panel">
                <div class="project-item__meta">
                  {project.featured && <span class="project-flag">Featured</span>}
                  <span class="project-order">0{idx + 1}</span>
                </div>

                <h3>{project.title}</h3>
                <p>{project.description}</p>

                <div class="project-tech">
                  {project.tech.map((tech) => (
                    <span>{tech}</span>
                  ))}
                </div>

                <a
                  href={project.github}
                  class="project-link"
                  target="_blank"
                  rel="noopener noreferrer"
                >
                  <i class="fa-brands fa-github" aria-hidden="true"></i>
                  View on GitHub
                  <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="square" stroke-linejoin="miter" stroke-width="2" d="M14 5h5v5m0-5-9 9m-3 5h10"></path></svg>
                </a>
              </article>
            ))}
          </div>
        </div>
      </div>
    </section>

    <section class="home-chapter" id="achievements" data-chapter="04" data-chapter-title="Achievements">
      <div class="chapter-stage">
        <div class="chapter-grid chapter-grid--achievements">
          <p class="section-index">03</p>

          <div class="chapter-header chapter-header--stacked">
            <span>Achievements</span>
            <h2 class="chapter-heading">By the numbers<span>.</span></h2>
          </div>

          <div class="stats-grid">
            {stats.map((stat) => (
              <div class="stat-card panel">
                <div class="stat-value">
                  <span class="counter-value" data-target={stat.value}>0</span><span>{stat.suffix}</span>
                </div>
                <p>{stat.label}</p>
              </div>
            ))}
          </div>

          <div class="awards-grid">
            {awards.map((award) => (
              <div class="award-item panel">
                <i class={`fa-solid ${award.icon}`} aria-hidden="true"></i>
                <div>
                  <h3>{award.title}</h3>
                  <p>{award.event}</p>
                </div>
              </div>
            ))}
          </div>

          <a href="/awards" class="header-link awards-link">
            View all awards
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="square" stroke-linejoin="miter" stroke-width="2" d="M5 12h14m-4-4 4 4-4 4"></path></svg>
          </a>
        </div>
      </div>
    </section>

    <section class="home-chapter" id="blog" data-chapter="05" data-chapter-title="Writing">
      <div class="chapter-stage">
        <div class="chapter-grid chapter-grid--blog">
          <p class="section-index">04</p>

          <div class="blog-overview">
            <span>From the Blog</span>
            <h2 class="chapter-heading">Latest writing<span>.</span></h2>
            <p>Thoughts on technology, economics, and everything in between.</p>
            <a href="/blog" class="header-link">
              View all posts
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="square" stroke-linejoin="miter" stroke-width="2" d="M5 12h14m-4-4 4 4-4 4"></path></svg>
            </a>
          </div>

          {latestPost && (
            <article class="latest-post panel">
              <div class="latest-post__meta">
                {latestPost.data.category && <span>{latestPost.data.category}</span>}
                <time datetime={latestPost.data.date}>
                  {new Date(latestPost.data.date).toLocaleDateString('en-US', {
                    month: 'long',
                    day: 'numeric',
                    year: 'numeric'
                  })}
                </time>
              </div>

              <h3>{latestPost.data.title}</h3>

              {latestPost.data.excerpt && <p>{latestPost.data.excerpt}</p>}

              {latestPost.data.tags && (
                <div class="latest-post__tags">
                  {latestPost.data.tags.slice(0, 4).map((tag) => (
                    <span>#{tag}</span>
                  ))}
                </div>
              )}

              <a href={`/blog/${latestPost.slug}`} class="project-link">
                Read article
                <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="square" stroke-linejoin="miter" stroke-width="2" d="M5 12h14m-4-4 4 4-4 4"></path></svg>
              </a>
            </article>
          )}
        </div>
      </div>
    </section>

    <section class="home-chapter home-chapter--connect" id="connect" data-chapter="06" data-chapter-title="Connect">
      <div class="chapter-stage">
        <div class="chapter-grid chapter-grid--connect">
          <div class="connect-copy">
            <h2 class="chapter-heading">Let's build something <span>together</span>.</h2>
            <p>I'm always interested in collaborating on open-source projects, discussing economics, or just chatting about technology.</p>

            <div class="social-row">
              {socialLinks.map((link) => (
                <a href={link.href} target="_blank" rel="noopener noreferrer" aria-label={link.label}>
                  <i class={link.icon} aria-hidden="true"></i>
                </a>
              ))}
              <a href="mailto:james20081204@gmail.com" aria-label="Send email">
                <i class="fa-regular fa-envelope" aria-hidden="true"></i>
              </a>
            </div>

            <a href="mailto:james20081204@gmail.com" class="action action--primary action--mail">
              <i class="fa-regular fa-envelope" aria-hidden="true"></i>
              Get in Touch
            </a>
          </div>
        </div>
      </div>
    </section>
  </div>
</Layout>

<style>
  .home-editorial {
    --home-bg-0: #080808;
    --home-bg-1: #101011;
    --home-bg-2: #161618;
    --home-bg-3: #1d1d21;
    --home-panel: #121214;
    --home-panel-alt: #17171a;
    --home-text-1: #eceae5;
    --home-text-2: #b1aea6;
    --home-text-3: #73706a;
    --home-line-soft: rgba(255, 255, 255, 0.08);
    --home-line-strong: rgba(255, 255, 255, 0.16);
    --home-accent: #e8a838;
    --home-accent-muted: #c4893a;
    --home-shadow-hard: 6px 6px 0 rgba(0, 0, 0, 0.35);
    --home-radius-1: 2px;
    --home-radius-2: 4px;

    position: relative;
    isolation: isolate;
    background:
      radial-gradient(circle at 12% 16%, rgba(232, 168, 56, 0.08) 0%, transparent 34%),
      radial-gradient(circle at 86% 60%, rgba(232, 168, 56, 0.05) 0%, transparent 30%),
      linear-gradient(180deg, var(--home-bg-0) 0%, var(--home-bg-1) 28%, var(--home-bg-2) 72%, var(--home-bg-0) 100%);
  }

  .home-editorial::before {
    content: '';
    position: absolute;
    inset: 0;
    pointer-events: none;
    background-image: repeating-linear-gradient(
      to right,
      transparent 0,
      transparent 52px,
      rgba(255, 255, 255, 0.025) 52px,
      rgba(255, 255, 255, 0.025) 53px
    );
    z-index: -1;
  }

  .home-chapter {
    --chapter-progress: 0;
    --chapter-enter: 0;
    --chapter-hold: 0;
    --chapter-exit: 0;
    --chapter-visibility: 0;

    position: relative;
    min-height: 186vh;
    border-top: 1px solid var(--home-line-soft);
  }

  .home-chapter--hero {
    min-height: 100vh;
    overflow: clip;
    --chapter-visibility: 1;
    --chapter-enter: 1;
    --chapter-hold: 1;
    --chapter-exit: 0;
  }


  .home-chapter:first-of-type {
    border-top: none;
  }

  .chapter-stage {
    position: sticky;
    top: 3.5rem;
    min-height: calc(100vh - 3.5rem);
    display: flex;
    align-items: center;
    padding: clamp(1.1rem, 2vw, 2.4rem) 0;
  }

  .chapter-grid {
    width: min(1240px, calc(100vw - 3rem));
    margin: 0 auto;
    display: grid;
    grid-template-columns: repeat(12, minmax(0, 1fr));
    gap: clamp(0.8rem, 1.8vw, 1.3rem);
    align-items: start;
  }

  .section-index {
    grid-column: 1 / span 2;
    margin: 0;
    font-family: 'JetBrains Mono', monospace;
    font-size: clamp(3.5rem, 9vw, 8.5rem);
    line-height: 0.9;
    color: rgba(255, 255, 255, 0.06);
    pointer-events: none;
  }

  .chapter-kicker,
  .chapter-title,
  .chapter-lead,
  .chapter-meta,
  .chapter-heading,
  .chapter-copy p,
  .chapter-copy .chapter-split,
  .chapter-header,
  .chapter-actions,
  .project-list,
  .stats-grid,
  .awards-grid,
  .blog-overview,
  .latest-post,
  .connect-copy,
  .chapter-photo,
  .awards-link {
    --entry-x: -22px;
    --entry-y: 28px;
    --exit-x: 16px;
    --exit-y: 14px;
    --entry-scale: 0.968;
    --exit-scale: 0.985;

    opacity: var(--chapter-visibility);
    transform: translate3d(
      calc((1 - var(--chapter-enter)) * var(--entry-x) + var(--chapter-exit) * var(--exit-x)),
      calc((1 - var(--chapter-enter)) * var(--entry-y) - var(--chapter-exit) * var(--exit-y)),
      0
    ) scale(
      calc(
        var(--entry-scale) +
        (var(--chapter-enter) * (1 - var(--entry-scale))) -
        (var(--chapter-exit) * (1 - var(--exit-scale)))
      )
    );
    transition: transform 220ms linear, opacity 220ms linear;
  }

  .panel {
    border: 1px solid var(--home-line-soft);
    background: linear-gradient(180deg, var(--home-panel) 0%, var(--home-panel-alt) 100%);
    border-radius: var(--home-radius-2);
    box-shadow: var(--home-shadow-hard);
  }

  .chapter-grid--hero {
    position: relative;
    z-index: 1;
    align-content: end;
    min-height: 100%;
    width: min(1420px, calc(100vw - 2.25rem));
    padding-bottom: clamp(2rem, 5vh, 4rem);
  }

  .home-chapter--hero .chapter-stage {
    top: 0;
    min-height: calc(100vh - 3.5rem);
    align-items: center;
    padding: clamp(3rem, 9vh, 7rem) 0 clamp(1.25rem, 3vh, 2.5rem);
  }


  .chapter-grid--hero .chapter-kicker {
    grid-column: 3 / span 7;
    margin: 0;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.69rem;
    letter-spacing: 0.26em;
    text-transform: uppercase;
    color: var(--home-text-3);
    --entry-x: -90px;
    --entry-y: 62px;
    --exit-x: 68px;
    --exit-y: 24px;
  }

  .chapter-grid--hero .chapter-title {
    grid-column: 3 / span 8;
    margin: 0;
    font-family: 'Instrument Serif', Georgia, serif;
    font-size: clamp(3.2rem, 9.6vw, 8.2rem);
    font-weight: 400;
    line-height: 0.92;
    color: var(--home-text-1);
    max-width: 15ch;
    --entry-x: -66px;
    --entry-y: 46px;
    --exit-x: 86px;
    --exit-y: 36px;
    --entry-scale: 0.94;
    --exit-scale: 0.97;
  }

  .chapter-grid--hero .chapter-title span {
    color: var(--home-accent);
  }

  .chapter-grid--hero .chapter-lead {
    grid-column: 3 / span 6;
    margin: 0;
    max-width: 36rem;
    font-size: clamp(1.05rem, 2.15vw, 1.52rem);
    line-height: 1.56;
    color: var(--home-text-2);
    --entry-x: -38px;
    --entry-y: 34px;
    --exit-x: 50px;
    --exit-y: 22px;
  }

  .chapter-grid--hero .chapter-meta {
    grid-column: 3 / span 6;
    margin: 0;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.75rem;
    letter-spacing: 0.14em;
    text-transform: uppercase;
    color: var(--home-text-3);
    --entry-x: -30px;
    --entry-y: 28px;
    --exit-x: 26px;
    --exit-y: 10px;
  }

  .chapter-actions {
    grid-column: 3 / span 6;
    display: flex;
    flex-wrap: wrap;
    gap: 0.7rem;
    --entry-x: -28px;
    --entry-y: 26px;
    --exit-x: 18px;
    --exit-y: 8px;
  }

  .action {
    display: inline-flex;
    align-items: center;
    gap: 0.55rem;
    padding: 0.76rem 1.1rem;
    border-radius: var(--home-radius-1);
    border: 1px solid transparent;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.72rem;
    letter-spacing: 0.13em;
    text-transform: uppercase;
    transition: transform 180ms ease, color 180ms ease, background-color 180ms ease, border-color 180ms ease;
  }

  .action:hover {
    transform: translate(-2px, -2px);
  }

  .action--primary {
    background: var(--home-accent);
    color: #0b0b0b;
    border-color: rgba(0, 0, 0, 0.3);
  }

  .action--secondary {
    background: #151518;
    border-color: var(--home-line-strong);
    color: var(--home-text-1);
  }


  .editorial-strip {
    overflow: hidden;
    border-top: 1px solid var(--home-line-soft);
    border-bottom: 1px solid var(--home-line-soft);
    background: #0b0b0c;
    padding: 0.8rem 0;
  }

  .editorial-strip__track {
    display: flex;
    width: max-content;
    animation: strip-scroll 28s linear infinite;
    will-change: transform;
  }

  .editorial-strip__set {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding-inline-end: 1rem;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.68rem;
    letter-spacing: 0.13em;
    text-transform: uppercase;
    color: var(--home-text-3);
    flex-shrink: 0;
  }

  .editorial-strip .sep {
    color: rgba(232, 168, 56, 0.55);
  }

  @keyframes strip-scroll {
    from { transform: translateX(0); }
    to { transform: translateX(-50%); }
  }

  .chapter-heading {
    margin: 0;
    font-family: 'Instrument Serif', Georgia, serif;
    font-weight: 400;
    font-size: clamp(2.2rem, 5.5vw, 4.6rem);
    line-height: 0.98;
    color: var(--home-text-1);
  }

  .chapter-heading span {
    color: var(--home-accent);
  }

  .chapter-grid--identity .chapter-photo {
    grid-column: 3 / span 3;
    padding: 1rem;
  }

  .chapter-photo img {
    width: 100%;
    aspect-ratio: 1 / 1;
    object-fit: cover;
    border-radius: var(--home-radius-2);
    border: 1px solid var(--home-line-soft);
  }

  .chapter-photo figcaption {
    margin-top: 1rem;
    display: grid;
    gap: 0.6rem;
  }

  .chapter-photo figcaption div {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.67rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--home-text-2);
  }

  .chapter-photo figcaption i {
    color: var(--home-accent-muted);
    width: 0.9rem;
  }

  .chapter-grid--identity .chapter-copy {
    grid-column: 6 / span 6;
    display: grid;
    gap: 1rem;
  }

  .chapter-copy p {
    margin: 0;
    color: var(--home-text-2);
    line-height: 1.65;
    font-size: 1.02rem;
  }

  .chapter-split {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0.8rem;
    margin-top: 0.4rem;
  }

  .chapter-split .panel {
    padding: 0.85rem 0.95rem;
    display: grid;
    gap: 0.45rem;
  }

  .panel-label {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.66rem;
    letter-spacing: 0.14em;
    text-transform: uppercase;
    color: var(--home-text-3);
  }

  .panel-value {
    color: var(--home-text-1);
    font-size: 1rem;
  }

  .panel-link:hover {
    border-color: rgba(232, 168, 56, 0.45);
    transform: translate(-2px, -2px);
  }

  .chapter-grid--projects .chapter-header {
    grid-column: 3 / span 4;
    display: grid;
    gap: 0.8rem;
  }

  .chapter-header > span,
  .blog-overview > span {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.68rem;
    letter-spacing: 0.16em;
    text-transform: uppercase;
    color: var(--home-text-3);
  }

  .header-link {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    width: fit-content;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.69rem;
    letter-spacing: 0.14em;
    text-transform: uppercase;
    color: var(--home-text-2);
    border-bottom: 1px solid var(--home-line-soft);
    padding-bottom: 0.35rem;
    transition: color 180ms ease, border-color 180ms ease, transform 180ms ease;
  }

  .header-link:hover {
    color: var(--home-accent);
    border-color: rgba(232, 168, 56, 0.45);
    transform: translateX(2px);
  }

  .chapter-grid--projects .project-list {
    grid-column: 7 / span 5;
    display: grid;
    gap: 0.8rem;
  }

  .project-item {
    padding: 1rem;
    display: grid;
    gap: 0.72rem;
  }

  .project-item__meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .project-flag {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.62rem;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    color: #141414;
    background: var(--home-accent);
    padding: 0.22rem 0.45rem;
    border-radius: var(--home-radius-1);
  }

  .project-order {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.67rem;
    color: var(--home-text-3);
  }

  .project-item h3,
  .award-item h3,
  .latest-post h3 {
    margin: 0;
    font-family: 'Instrument Serif', Georgia, serif;
    font-weight: 400;
    font-size: 1.6rem;
    line-height: 1.1;
    color: var(--home-text-1);
  }

  .project-item p,
  .award-item p,
  .latest-post p,
  .connect-copy p,
  .blog-overview p {
    margin: 0;
    color: var(--home-text-2);
    line-height: 1.58;
  }

  .project-tech,
  .latest-post__tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.45rem;
  }

  .project-tech span,
  .latest-post__tags span {
    border: 1px solid var(--home-line-soft);
    background: rgba(255, 255, 255, 0.02);
    color: var(--home-text-2);
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.62rem;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    padding: 0.2rem 0.45rem;
    border-radius: var(--home-radius-1);
  }

  .project-link {
    display: inline-flex;
    align-items: center;
    gap: 0.45rem;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.68rem;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    width: fit-content;
    color: var(--home-text-2);
    border: 1px solid var(--home-line-soft);
    padding: 0.46rem 0.64rem;
    border-radius: var(--home-radius-1);
    transition: color 180ms ease, border-color 180ms ease, transform 180ms ease;
  }

  .project-link:hover {
    color: var(--home-accent);
    border-color: rgba(232, 168, 56, 0.45);
    transform: translate(-1px, -1px);
  }

  .chapter-grid--achievements .chapter-header {
    grid-column: 3 / span 9;
    display: grid;
    gap: 0.8rem;
  }

  .stats-grid {
    grid-column: 3 / span 9;
    display: grid;
    grid-template-columns: repeat(4, minmax(0, 1fr));
    gap: 0.8rem;
  }

  .stat-card {
    padding: 1rem;
    display: grid;
    gap: 0.35rem;
  }

  .stat-value {
    font-family: 'Instrument Serif', Georgia, serif;
    font-size: clamp(2rem, 5vw, 3.4rem);
    line-height: 1;
    color: var(--home-text-1);
  }

  .stat-value span:last-child {
    color: var(--home-accent);
  }

  .stat-card p {
    margin: 0;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.66rem;
    letter-spacing: 0.14em;
    text-transform: uppercase;
    color: var(--home-text-3);
  }

  .awards-grid {
    grid-column: 3 / span 9;
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 0.8rem;
  }

  .award-item {
    padding: 0.9rem;
    display: grid;
    grid-template-columns: auto 1fr;
    gap: 0.75rem;
    align-items: start;
  }

  .award-item i {
    margin-top: 0.2rem;
    color: var(--home-accent-muted);
    font-size: 0.92rem;
  }

  .award-item h3 {
    font-size: 1.05rem;
  }

  .award-item p {
    margin-top: 0.25rem;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.64rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--home-text-3);
  }

  .awards-link {
    grid-column: 3 / span 9;
    margin-top: 0.35rem;
  }

  .chapter-grid--blog .blog-overview {
    grid-column: 3 / span 4;
    display: grid;
    gap: 0.95rem;
  }

  .chapter-grid--blog .latest-post {
    grid-column: 7 / span 5;
    padding: 1.1rem;
    display: grid;
    gap: 0.9rem;
  }

  .latest-post__meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 0.75rem;
    flex-wrap: wrap;
  }

  .latest-post__meta span {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.64rem;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    color: #151515;
    background: var(--home-accent);
    padding: 0.22rem 0.45rem;
    border-radius: var(--home-radius-1);
  }

  .latest-post__meta time {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.63rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--home-text-3);
  }

  .chapter-grid--connect {
    align-content: center;
  }

  .connect-copy {
    grid-column: 3 / span 8;
    display: grid;
    gap: 1rem;
  }

  .connect-copy .chapter-heading span {
    color: var(--home-accent);
  }

  .social-row {
    display: flex;
    flex-wrap: wrap;
    gap: 0.55rem;
  }

  .social-row a {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 2.15rem;
    height: 2.15rem;
    border: 1px solid var(--home-line-soft);
    background: #141417;
    border-radius: var(--home-radius-1);
    color: var(--home-text-3);
    transition: color 180ms ease, border-color 180ms ease, transform 180ms ease;
  }

  .social-row a:hover {
    color: var(--home-accent);
    border-color: rgba(232, 168, 56, 0.45);
    transform: translate(-1px, -1px);
  }

  .action--mail {
    width: fit-content;
  }

  @media (max-width: 1279px) {
    .chapter-grid {
      width: min(1060px, calc(100vw - 3rem));
    }

    .chapter-grid--hero .hero-ruler {
      grid-column: 1 / span 1;
    }

    .chapter-grid--hero .chapter-title,
    .chapter-grid--hero .chapter-kicker,
    .chapter-grid--hero .chapter-lead,
    .chapter-grid--hero .chapter-meta,
    .chapter-actions {
      grid-column: 2 / span 10;
    }

    .section-index {
      grid-column: 1 / span 2;
      font-size: clamp(3rem, 7vw, 6rem);
    }

    .chapter-grid--identity .chapter-photo {
      grid-column: 3 / span 4;
    }

    .chapter-grid--identity .chapter-copy {
      grid-column: 7 / span 5;
    }

    .chapter-grid--projects .chapter-header,
    .chapter-grid--blog .blog-overview {
      grid-column: 3 / span 5;
    }

    .chapter-grid--projects .project-list,
    .chapter-grid--blog .latest-post {
      grid-column: 8 / span 4;
    }

    .chapter-grid--achievements .chapter-header,
    .stats-grid,
    .awards-grid,
    .awards-link {
      grid-column: 3 / span 9;
    }

    .chapter-grid--connect .connect-copy {
      grid-column: 2 / span 10;
    }
  }

  @media (max-width: 1023px) {
    .home-chapter {
      min-height: auto;
      padding: 3.8rem 0;
      border-top: 1px solid var(--home-line-soft);
    }

    .home-chapter--hero {
      min-height: auto;
    }

    .chapter-grid--hero .hero-ruler {
      display: none;
    }

    .chapter-stage {
      position: relative;
      top: auto;
      min-height: auto;
      padding: 0;
    }

    .chapter-grid {
      width: min(760px, calc(100vw - 2rem));
      grid-template-columns: repeat(6, minmax(0, 1fr));
      gap: 0.75rem;
    }

    .section-index {
      grid-column: 1 / span 6;
      font-size: 2.8rem;
      margin-bottom: 0.2rem;
    }

    .chapter-grid--hero .chapter-kicker,
    .chapter-grid--hero .chapter-title,
    .chapter-grid--hero .chapter-lead,
    .chapter-grid--hero .chapter-meta,
    .chapter-actions,
    .chapter-grid--hero .hero-ruler,
      .chapter-grid--identity .chapter-photo,
    .chapter-grid--identity .chapter-copy,
    .chapter-grid--projects .chapter-header,
    .chapter-grid--projects .project-list,
    .chapter-grid--achievements .chapter-header,
    .stats-grid,
    .awards-grid,
    .awards-link,
    .chapter-grid--blog .blog-overview,
    .chapter-grid--blog .latest-post,
    .chapter-grid--connect .connect-copy {
      grid-column: 1 / span 6;
    }

    .chapter-split,
    .stats-grid,
    .awards-grid {
      grid-template-columns: 1fr;
    }

    .editorial-strip {
      padding: 0.6rem 0;
    }

    .editorial-strip__track {
      animation: none;
      width: auto;
      flex-wrap: wrap;
      gap: 0.55rem;
      padding-inline: 1rem;
      justify-content: center;
    }

    .chapter-kicker,
    .chapter-title,
    .chapter-lead,
    .chapter-meta,
    .chapter-heading,
    .chapter-copy p,
    .chapter-copy .chapter-split,
    .chapter-header,
    .project-list,
    .stats-grid,
    .awards-grid,
    .blog-overview,
    .latest-post,
    .connect-copy,
        .chapter-photo,
    .awards-link {
      opacity: 1;
      transform: none;
      transition: none;
    }

    .chapter-grid--hero .chapter-title {
      font-size: clamp(2.3rem, 14vw, 3.8rem);
    }

    .chapter-heading {
      font-size: clamp(1.9rem, 11vw, 3.1rem);
    }

    .project-item h3,
    .latest-post h3 {
      font-size: 1.35rem;
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .editorial-strip__track {
      animation: none;
    }

    .chapter-kicker,
    .chapter-title,
    .chapter-lead,
    .chapter-meta,
    .chapter-heading,
    .chapter-copy p,
    .chapter-copy .chapter-split,
    .chapter-header,
    .project-list,
    .stats-grid,
    .awards-grid,
    .blog-overview,
    .latest-post,
    .connect-copy,
        .chapter-photo,
    .awards-link {
      opacity: 1;
      transform: none;
      transition: none;
    }
  }
</style>

<script>
  function clamp(value, min, max) {
    return Math.min(Math.max(value, min), max);
  }

  function initHomeStory() {
    const previousCleanup = window.__homeStoryCleanup;
    if (typeof previousCleanup === 'function') {
      previousCleanup();
    }

    const homeRoot = document.getElementById('home-editorial');
    if (!homeRoot) {
      window.__homeStoryCleanup = null;
      return;
    }

    const chapters = Array.from(document.querySelectorAll('.home-chapter[data-chapter]'));
    const counterNodes = Array.from(document.querySelectorAll('.counter-value'));


    const reducedMotionMedia = window.matchMedia('(prefers-reduced-motion: reduce)');
    let cinematicEnabled = window.innerWidth >= 1024 && !reducedMotionMedia.matches;
    let ticking = false;

    function animateCounter(node) {
      const target = Number(node.getAttribute('data-target') || 0);
      const duration = 1700;
      const start = performance.now();

      function step(now) {
        const progress = clamp((now - start) / duration, 0, 1);
        const eased = 1 - Math.pow(1 - progress, 3);
        node.textContent = String(Math.round(eased * target));
        if (progress < 1) {
          requestAnimationFrame(step);
        }
      }

      requestAnimationFrame(step);
    }

    function updateCounters() {
      counterNodes.forEach((node) => {
        if (node.dataset.counted === 'true') {
          return;
        }
        const rect = node.getBoundingClientRect();
        const inView = rect.top < window.innerHeight * 0.85 && rect.bottom > window.innerHeight * 0.2;
        if (inView) {
          node.dataset.counted = 'true';
          animateCounter(node);
        }
      });
    }

    function updateChapters(scrollY) {
      const viewportHeight = window.innerHeight;
      let activeChapter = chapters[0] || null;
      let activeScore = -Infinity;

      chapters.forEach((chapter, index) => {
        if (!cinematicEnabled) {
          chapter.style.setProperty('--chapter-progress', '1');
          chapter.style.setProperty('--chapter-enter', '1');
          chapter.style.setProperty('--chapter-hold', '1');
          chapter.style.setProperty('--chapter-exit', '0');
          chapter.style.setProperty('--chapter-visibility', '1');
          chapter.setAttribute('data-phase', 'hold');
          if (!activeChapter || chapter.id === 'hero') {
            activeChapter = chapter;
          }
          return;
        }

        const isHero = chapter.classList.contains('home-chapter--hero');

        if (isHero) {
          chapter.style.setProperty('--chapter-progress', '1');
          chapter.style.setProperty('--chapter-enter', '1');
          chapter.style.setProperty('--chapter-hold', '1');
          chapter.style.setProperty('--chapter-exit', '0');
          chapter.style.setProperty('--chapter-visibility', '1');
          chapter.setAttribute('data-phase', 'hold');
          activeChapter = chapter;
          return;
        }

        const chapterTop = chapter.offsetTop;
        const chapterDistance = Math.max(chapter.offsetHeight - viewportHeight * 0.16, viewportHeight * 0.86);
        const chapterStart = chapterTop - viewportHeight * 0.1;

        const progress = clamp((scrollY - chapterStart) / chapterDistance, 0, 1);
        const enterEnd = 0.2;
        const holdEnd = 0.75;
        const enter = clamp(progress / enterEnd, 0, 1);
        const hold = clamp((progress - enterEnd) / (holdEnd - enterEnd), 0, 1);
        const exit = clamp((progress - holdEnd) / (1 - holdEnd), 0, 1);
        const visibility = progress < enterEnd ? enter : progress < holdEnd ? 1 : 1 - exit;

        chapter.style.setProperty('--chapter-progress', progress.toFixed(4));
        chapter.style.setProperty('--chapter-enter', enter.toFixed(4));
        chapter.style.setProperty('--chapter-hold', hold.toFixed(4));
        chapter.style.setProperty('--chapter-exit', exit.toFixed(4));
        chapter.style.setProperty('--chapter-visibility', visibility.toFixed(4));

        if (progress < enterEnd) {
          chapter.setAttribute('data-phase', 'enter');
        } else if (progress < holdEnd) {
          chapter.setAttribute('data-phase', 'hold');
        } else {
          chapter.setAttribute('data-phase', 'exit');
        }

        const score = visibility + hold * 0.45 - index * 0.01;
        if (score >= activeScore) {
          activeScore = score;
          activeChapter = chapter;
        }
      });

    }

    function updateStory() {
      const scrollY = window.scrollY;
      updateChapters(scrollY);
      updateCounters();
    }

    function onScroll() {
      if (ticking) {
        return;
      }
      ticking = true;
      requestAnimationFrame(() => {
        updateStory();
        ticking = false;
      });
    }

    function onResize() {
      cinematicEnabled = window.innerWidth >= 1024 && !reducedMotionMedia.matches;
      updateStory();
    }

    function onMotionPreferenceChange() {
      cinematicEnabled = window.innerWidth >= 1024 && !reducedMotionMedia.matches;
      updateStory();
    }

    window.addEventListener('scroll', onScroll, { passive: true });
    window.addEventListener('resize', onResize);
    if (typeof reducedMotionMedia.addEventListener === 'function') {
      reducedMotionMedia.addEventListener('change', onMotionPreferenceChange);
    } else if (typeof reducedMotionMedia.addListener === 'function') {
      reducedMotionMedia.addListener(onMotionPreferenceChange);
    }

    updateStory();

    window.__homeStoryCleanup = () => {
      window.removeEventListener('scroll', onScroll);
      window.removeEventListener('resize', onResize);
      if (typeof reducedMotionMedia.removeEventListener === 'function') {
        reducedMotionMedia.removeEventListener('change', onMotionPreferenceChange);
      } else if (typeof reducedMotionMedia.removeListener === 'function') {
        reducedMotionMedia.removeListener(onMotionPreferenceChange);
      }
    };
  }

  if (window.__homeStoryPageLoadHandler) {
    document.removeEventListener('astro:page-load', window.__homeStoryPageLoadHandler);
  }

  window.__homeStoryPageLoadHandler = initHomeStory;
  document.addEventListener('astro:page-load', window.__homeStoryPageLoadHandler);

  initHomeStory();
</script>
