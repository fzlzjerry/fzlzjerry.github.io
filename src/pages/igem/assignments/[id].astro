---
import Layout from '../../../layouts/Layout.astro';
import { assignments } from '../../../data/assignments';

export function getStaticPaths() {
  return assignments.map(assignment => ({
    params: { id: assignment.id },
    props: { assignment }
  }));
}

const { assignment } = Astro.props;
---

<Layout title={`${assignment.title} - iGEM - Morax Cheng`} description={assignment.description}>
  <div class="space-y-8">
    <header class="space-y-4">
      <a href="/igem/assignments" class="inline-flex items-center gap-2" style="color: var(--text-muted-light); text-decoration: underline; text-decoration-thickness: 1px; text-underline-offset: 0.2em;">
        <i class="fas fa-arrow-left"></i>
        Back to Assignments
      </a>
      <div>
        <h1 class="text-3xl mb-2" style="font-weight: 300; letter-spacing: 0.05em;">{assignment.title}</h1>
        <div class="flex items-center gap-4" style="color: var(--text-muted-light); padding-bottom: 1rem; border-bottom: 1px solid var(--border-light);">
          <time datetime={assignment.date}>
            <i class="far fa-calendar-alt mr-1"></i>
            {assignment.date}
          </time>
          <span>
            <i class="far fa-user mr-1"></i>
            {assignment.author}
          </span>
        </div>
      </div>
    </header>

    <div class="space-y-8">
      {assignment.sections.map(section => (
        <div class="border rounded p-6" style="border-color: var(--border-light); background-color: var(--primary-light);">
          <h2 class="text-2xl mb-6 flex items-center gap-2" style="font-weight: 400; letter-spacing: 0.03em;">
            <i class={`fas fa-${section.title.toLowerCase().includes('overview') ? 'book' : 
                       section.title.toLowerCase().includes('deliverables') ? 'tasks' :
                       section.title.toLowerCase().includes('awards') ? 'trophy' :
                       section.title.toLowerCase().includes('notes') ? 'exclamation-circle' : 'info-circle'} 
                       font-icon`} style="color: var(--text-muted-light);"></i>
            {section.title}
          </h2>

          {section.items && (
            <ul class="space-y-4">
              {section.items.map(item => (
                <li class="flex items-start gap-3">
                  <i class={`fas fa-${item.icon} mt-1 w-5 font-icon`} style="color: var(--text-muted-light);"></i>
                  <span>{item.text}</span>
                </li>
              ))}
            </ul>
          )}

          {section.subsections && (
            <div class="space-y-8">
              {Object.entries(section.subsections).map(([key, subsection]) => (
                <div class="space-y-4">
                  <h3 class="text-xl flex items-center gap-2" style="font-weight: 500; letter-spacing: 0.02em;">
                    <i class={`fas fa-${key === 'medals' ? 'medal' : 'trophy'} font-icon`} style="color: var(--text-muted-light);"></i>
                    {subsection.title}
                  </h3>
                  {'description' in subsection && subsection.description && (
                    <p style="color: var(--text-muted-light); text-align: left;">{subsection.description}</p>
                  )}
                  {'items' in subsection && subsection.items && (
                    <ul class="space-y-3">
                      {subsection.items.map(item => (
                      <li class="flex items-start gap-3">
                        {key === 'medals' ? (
                          <>
                            <i class={`fas fa-medal mt-1 font-icon`} style="color: var(--text-muted-light);"></i>
                            <div>
                              <strong style="font-weight: 500;">{item.level}:</strong>
                              <span class="ml-1" style="color: var(--text-muted-light);">{item.criteria}</span>
                            </div>
                          </>
                        ) : (
                          <>
                            <i class={`fas fa-${item.icon} w-5 font-icon`} style="color: var(--text-muted-light);"></i>
                            <span>{item.name}</span>
                          </>
                        )}
                      </li>
                    ))}
                    </ul>
                  )}
                </div>
              ))}
            </div>
          )}
        </div>
      ))}
    </div>
  </div>
</Layout>

<style>
</style>

<script>
  // Add Font Awesome if not already added
  if (!document.querySelector('link[href*="font-awesome"]')) {
    const link = document.createElement('link');
    link.rel = 'stylesheet';
    link.href = 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css';
    document.head.appendChild(link);
  }
</script>